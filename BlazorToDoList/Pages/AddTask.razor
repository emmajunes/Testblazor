@page "/addtask"
@using BlazorToDoList.Data;
@using BlazorToDoList.Services;
@inject ITaskService TaskService;
@inject NavigationManager NavigationManager;

<h3>Add Task</h3>
<br />
<div>
    <EditForm Model="@taskItem" OnSubmit="@OnSubmit">
        Title: <br />
        <InputText id="title" @bind-Value="taskItem.TaskTitle" />
        <br />
        Description: <br />
        <InputText id="description" @bind-Value="taskItem.TaskDescription" />
        <br />
        Priority: <br />
        <InputSelect id="prio" @bind-Value="taskItem.TaskPrio" class="form-control w-25">

            @foreach (var prio in Enum.GetValues(typeof(Priority)))
            {
                <option value="@prio">@prio</option>
            }
        </InputSelect>
        <br />
        <button class="btn btn-primary"type="submit">Submit</button>
        <a href="" @onclick="@(()=> NavigationManager.NavigateTo("/singlelist"))" @onclick:preventDefault class="btn btn-secondary">Cancel</a>
    </EditForm>   
</div>

@code {
    private TaskItem taskItem = new();

    public async Task OnSubmit()
    {
        try
        {
            taskItem = await TaskService.AddTaskAsync(taskItem);
            NavigationManager.NavigateTo("/singlelist", true);
        }
        catch (Exception)
        {
            return;
        }     
    }
}
