@page "/editprofile"
@using BlazorToDoList.Data;
@using BlazorToDoList.Services;
@inject IUserService UserService;
@inject NavigationManager NavigationManager;

<h3>Edit profile</h3>

<div>
    <EditForm Model="@user" OnSubmit="@OnSubmit">
        Username: <br />
        <InputText id="name" @bind-Value="user.Username" />
        <br /><br />
        Password: <br />
        <InputText type="password" id="password" @bind-Value="user.Password" />
        <br /><br />
        Email:<br />
        <InputText id="email" @bind-Value="user.Email" />
        <br /><br />
        <button class="mb-5 btn btn-primary"type="submit">Update</button>
    </EditForm>
</div>

<a href="" @onclick="@(()=> NavigationManager.NavigateTo("/deleteuser"))" @onclick:preventDefault class="btn btn-danger">Delete your profile</a>
<a href="" @onclick="@(()=> NavigationManager.NavigateTo("/singleuser"))" @onclick:preventDefault class="btn btn-secondary">Go back</a>

@code {
    private UserItem user = new();

    protected override async Task OnInitializedAsync()
    {
        user = await UserService.GetSingleUserAsync();
    }

    public async Task OnSubmit()
    {
        try
        {
            user = await UserService.EditProfileAsync(user);
            NavigationManager.NavigateTo("/singleuser", true); //Funkar någorlunda men hur funkar det med admin?
        }
        catch (Exception)
        {
            return;
        }
        
    }
}
